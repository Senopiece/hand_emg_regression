# General search for the best model on averaged dataset

method: bayes

metric:
  name: val_lmerr
  goal: minimize

early_terminate:
  type: hyperband
  min_iter: 70
  max_iter: 300

parameters:
  # model config

  l1:
    values: [1e-2, 1e-3, 1e-4, 1e-5]
  
  l2:
    values: [1e-2, 1e-3, 1e-4, 1e-5]

  emg_samples_per_frame:
    values: [16, 32, 64]
  
  slices:
    min: 4
    max: 256
    distribution: int_uniform
  
  patterns:
    min: 4
    max: 256
    distribution: int_uniform
    
  frames_per_window:
    min: 4
    max: 16
    distribution: int_uniform
    
  slice_width:
    min: 4
    max: 128
    distribution: int_uniform
  
  mx_width:
    min: 2
    max: 128
    distribution: int_uniform
  
  mx_stride:
    min: 1
    max: 64
    distribution: int_uniform
    
  std_width:
    min: 2
    max: 128
    distribution: int_uniform
  
  std_stride:
    min: 1
    max: 64
    distribution: int_uniform
    
  synapse_features:
    values: [16, 32, 64, 128, 256, 512, 1024]
  
  muscle_features:
    values: [16, 32, 64, 128, 256, 512, 1024]
  
  predict_hidden_layer_size:
    values: [16, 32, 64, 128, 256, 512, 1024]
  
  emg_featurizer:
    values:
      - cnn
      - sts

  # dataset config

  recordings_usage:
    value: -1 # all

  val_usage:
    value: -1 # all
  
  epoch_time_limit:
    value: 600
  
  val_sample_ratio:
    value: 0.3

  val_window:
    value: 1000
  
  val_frames_per_patch:
    value: 320

  train_frames_per_patch:
    distribution: int_uniform
    min: 30
    max: 920

  train_sample_ratio:
    distribution: uniform
    min: 0.01
    max: 0.5
  
  patience:
    value: 50
  
  dataset_path:
    value: $rand:./datasets

command:
  - ${env}
  - ${interpreter}
  - -m
  - emg_hand_tracking.train
  - -n
  - ${args}
